<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <meta name="description" content="A simple animation in Bagel.js">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>
            The epic bagel animation
        </title>
    </head>
    <body bgColor="white">
        <p id="debug"></p>
    </body>
</html>
<script src="../bagel.js"></script>
<script>

game = Bagel.init({
    id: "Bagel",
    game: {
        assets: {
            imgs: [
                {
                    id: "Bagel",
                    src: "../assets/imgs/bagel.png"
                }
            ],
            snds: []
        },
        sprites: [
            {
                id: "Bagel",
                vars: {
                    debugDisplay: document.getElementById("debug")
                },
                visible: false,
                scripts: {
                    init: [
                        {
                            code: me => {
                                me.x = 0;
                                me.visible = false;
                                me.scale = 0.75;
                            },
                            stateToRun: "game"
                        }
                    ],
                    main: [
                        {
                            code: me => {
                                let i = 0;
                                while (i < 2) {
                                    me.clone();
                                    i++;
                                }

                                me.vars.debugDisplay.innerHTML = "FPS: " + game.currentFPS + ". <br> Bagel count: " + me.cloneCount;
                            },
                            stateToRun: "game"
                        }
                    ]
                },
                img: "Bagel",
                clones: {
                    visible: true,
                    scripts: {
                        init: [
                            me => {
                                me.visible = true;

                                me.x = game.width / 2;
                                me.y = game.height / 2;

                                me.angle = (Math.random() * 360) - 180;
                                me.move(-1); // The main code gets run on the first frame so this will cancel it out
                            }
                        ],
                        main: [
                            me => {
                                me.move(1);
                                me.alpha -= 0.002;

                                if (Math.abs(me.x - (game.height)) > game.width + me.width || Math.abs(me.y - (game.height / 2)) > game.height + me.height || me.alpha < 0) {
                                    me.delete();
                                }
                            }
                        ]
                    }
                }
            }
        ]
    },
    width: 800,
    height: 450,
    state: "game",
    config: {
        display: {
            mode: "fill"
            /*
            webgl: {
                minimumLimits: {
                    textureCount: 100
                }
            },
            renderer: "webgl"
            */
        },
        loading: {
            skip: false,
            mode: "dynamic"
        }
    }
});

</script>
